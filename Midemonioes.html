<!-- =========================================
     HTML — Inicio del marcado del documento
     ========================================= -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mi demonio es</title>
  <!-- Tipos góticos y display -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=UnifrakturMaguntia&display=swap" rel="stylesheet">

  <!-- =========================================
       CSS — Inicio de estilos del documento
       ========================================= -->
  <style>
    :root{
      --bg1:#0b0002;
      --bg2:#1a0006;
      --bg3:#2a000a;
      --accent:#ff2a2a;
      --accent-dark:#8b0000;
      --text:#e9e3e3;
      --muted:#b08c8c;
      --glow: 0 0 18px rgba(255, 0, 0, .45), 0 0 42px rgba(255, 0, 0, .25);
    }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0;
      color:var(--text);
      background: radial-gradient(1200px 800px at 20% 20%, #240006 0%, #120003 60%, #070002 100%),
                  linear-gradient(135deg, var(--bg1), var(--bg2) 35%, var(--bg3));
      background-blend-mode: screen, normal;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Cantarell, "Helvetica Neue", Arial, sans-serif;
      overflow-x:hidden;
    }
    .embers{
      position:fixed; inset:0; pointer-events:none; z-index:0;
      background:
        radial-gradient(3px 3px at 20% 80%, rgba(255,70,50,.5) 0, transparent 60%),
        radial-gradient(2px 2px at 70% 30%, rgba(255,120,90,.35) 0, transparent 60%),
        radial-gradient(2px 2px at 40% 50%, rgba(255,80,40,.35) 0, transparent 60%);
      animation: drift 14s linear infinite;
      filter: blur(0.3px);
    }
    @keyframes drift{
      0%{ transform: translateY(0) }
      50%{ transform: translateY(-12px) }
      100%{ transform: translateY(0) }
    }
    .wrap{
      position:relative;
      min-height:100%;
      display:grid;
      place-items:center;
      padding:48px 16px 96px;
      z-index:1;
    }
    .title{
      text-align:center;
      margin:0 0 24px;
      font-family: "UnifrakturMaguntia", "Cinzel", serif;
      font-size: clamp(28px, 6vw, 56px);
      letter-spacing: 1px;
      color:#f6d6d6;
      text-shadow:
        0 0 2px #fff,
        0 0 6px rgba(255,255,255,.3),
        0 0 18px rgba(255,0,0,.65),
        0 0 42px rgba(255,0,0,.35);
      position: relative;
    }
    .title.bloody{
      text-shadow:
        0 1px 0 #300000,
        0 2px 0 #400000,
        0 3px 0 #500000,
        0 4px 0 #600000,
        0 5px 2px #800000,
        0 8px 6px rgba(255, 0, 0, .25),
        0 14px 12px rgba(255, 0, 0, .15),
        0 22px 18px rgba(255, 0, 0, .08);
    }
    .card{
      width:min(880px, 92vw);
      background: rgba(20, 0, 0, .35);
      border: 1px solid rgba(255, 0, 0, .25);
      border-radius: 18px;
      box-shadow:
        0 8px 24px rgba(0,0,0,.6),
        inset 0 0 18px rgba(255,0,0,.08);
      backdrop-filter: blur(8px) saturate(110%);
      -webkit-backdrop-filter: blur(8px) saturate(110%);
      display:grid;
      grid-template-columns: 1fr;
      gap: 20px;
      padding: clamp(16px, 2.8vw, 28px);
      align-items:center;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:-1px;
      border-radius: 18px;
      box-shadow: var(--glow);
      pointer-events:none;
      opacity:.35;
    }
    .info{
      padding: 12px;
      text-align:center;
    }
    .info h2{
      margin: 0 0 10px;
      font-family: "Cinzel", serif;
      font-weight: 700;
      font-size: clamp(20px, 3.5vw, 32px);
      color:#ffd1d1;
      letter-spacing:.5px;
    }
    .meta{
      display:grid;
      gap:10px;
      margin: 10px 0 0;
      font-size: clamp(14px, 2.4vw, 18px);
      color: var(--muted);
      justify-items:center;
    }
    .meta strong{
      color: #ffb3b3;
      text-shadow: 0 0 6px rgba(255,0,0,.45);
    }
    .actions{
      display:flex; gap:14px; flex-wrap:wrap; margin-top: 14px; justify-content:center;
    }
    .btn{
      appearance:none; border:none; cursor:pointer;
      padding:12px 18px;
      border-radius: 12px;
      font-weight:700;
      letter-spacing:.5px;
      color:#fff;
      background:
        radial-gradient(120% 220% at 50% -20%, #ff6a00 0, rgba(255, 0, 0, .85) 40%, #7a0000 100%);
      box-shadow:
        0 6px 18px rgba(255, 0, 0, .35),
        inset 0 0 18px rgba(255, 160, 120, .25);
      transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
    }
    .btn:hover{
      transform: translateY(-2px);
      box-shadow:
        0 10px 26px rgba(255, 0, 0, .45),
        inset 0 0 22px rgba(255, 180, 150, .3);
      filter: brightness(1.05);
    }
    .btn.secondary{
      background:
        linear-gradient(180deg, #2a0008, #45000f);
      box-shadow: inset 0 0 12px rgba(255,0,0,.25), 0 4px 12px rgba(0,0,0,.5);
      color:#ffbdbd;
    }
    .footer{
      margin-top: 6px;
      font-size: 12px;
      color: #8b5a5a;
      text-align:center;
    }

    /* Panel VS con Grid: 1fr auto 1fr para (imagen – VS – imagen) */
    .versus{
      position: relative;
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      align-items: center;
      gap: clamp(10px, 3vw, 22px);
    }
    .vs{
      font-family: "Cinzel", serif;
      font-weight: 700;
      letter-spacing: 1px;
      font-size: clamp(20px, 6vw, 42px);
      color: #ffd1d1;
      text-shadow:
        0 0 2px #fff,
        0 0 6px rgba(255,255,255,.3),
        0 0 18px rgba(255,0,0,.65),
        0 0 42px rgba(255,0,0,.35);
      padding: 6px 10px;
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(20,0,0,.35), rgba(40,0,0,.35));
      border: 1px solid rgba(255,0,0,.35);
      box-shadow: inset 0 0 12px rgba(255,0,0,.2);
    }

    /* AUMENTO DE ALTURA: más altos hacia arriba sin distorsionar */
    .art{
      position:relative;
      border-radius: 14px;
      overflow:hidden;
      border:1px solid rgba(255, 0, 0, .25);
      background: rgba(0,0,0,.25);
      box-shadow: inset 0 0 18px rgba(255,0,0,.08);
      min-height: clamp(220px, 36vw, 420px); /* altura mínima mayor y fluida */
    }
    .art img{
      width:100%;
      height:100%;                /* el img rellena toda la altura del marco */
      object-fit: cover;          /* recorta manteniendo proporción */
      object-position: center;    /* centra el recorte */
      aspect-ratio: 3 / 4;        /* más vertical que 4/3 para “subir” altura */
      display:block;
      filter: saturate(110%) contrast(105%);
    }
    .art::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(80% 80% at 50% 10%, transparent 0 55%, rgba(255,0,0,.08) 70%, rgba(0,0,0,.35) 100%);
      pointer-events:none;
    }

    @media (max-width: 640px){
      .versus{
        grid-template-columns: 1fr;
      }
      .vs{ justify-self: center; order: 2; }
      .art.left{ order: 1; }
      .art.right{ order: 3; }
      .art{ min-height: clamp(220px, 56vw, 520px); } /* más alto en móviles */
    }
  </style>
</head>
<body>
  <div class="embers"></div>
  <main class="wrap">
    <h1 class="title bloody">Mi demonio es</h1>

    <section id="card" class="card">
      <div class="info">
        <h2 id="nombre">Invocando...</h2>
        <div class="meta">
          <div>Rango: <strong id="rango">—</strong></div>
          <div>Fuerza: <strong id="fuerza">—</strong></div>
        </div>
        <div class="actions">
          <button class="btn" id="btn-recargar">Invocar otro</button>
          <button class="btn secondary" id="btn-refrescar">Recargar página</button>
        </div>
        <p class="footer">Forjado en sombras y fuego.</p>
      </div>

      <!-- Panel de enfrentamiento -->
      <div class="versus">
        <figure class="art left">
          <img id="imagen1" src="http://127.0.0.1:8000/static/Peppadiablo.png" alt="Ilustración demoniaca A">
        </figure>

        <span class="vs" aria-hidden="true">VS</span>

        <figure class="art right">
          <img id="imagen2" src="http://127.0.0.1:8000/static/Peppadiablo.png" alt="Ilustración demoniaca B">
        </figure>
      </div>
    </section>
  </main>

  <!-- =========================================
       JavaScript — Inicio de la lógica de la app
       ========================================= -->
  <script>
async function fetchCarta() {
  const url = 'http://127.0.0.1:8000/api-card-demonic/demonic/card/random';
  const resp = await fetch(url, {
    method: 'GET',
    headers: { 'X-API-KEY': 1234 } // o quita este header si no estás usando API-key
  });
  if (!resp.ok) throw new Error('HTTP ' + resp.status);
  return resp.json(); // ahora devuelve un array con 2 cartas
}

function normalizaImagen(path){
  if (!path) return 'http://127.0.0.1:8000/static/Peppadiablo.png';
  return path.startsWith('http') ? path : ('http://127.0.0.1:8000' + path);
}

async function cargar() {
  try {
    const cartas = await fetchCarta(); // solo una llamada
    const [a, b] = cartas;             // desestructuramos las 2 cartas

    document.getElementById('nombre').textContent = `${a.nombre ?? '¿Sin nombre?'} vs ${b.nombre ?? '¿Sin nombre?'}`;
    document.getElementById('rango').textContent  = `${a.rango ?? '—'} vs ${b.rango ?? '—'}`;
    document.getElementById('fuerza').textContent = `${a.fuerza ?? '—'} vs ${b.fuerza ?? '—'}`;
    document.getElementById('imagen1').src = normalizaImagen(a.imagen);
    document.getElementById('imagen2').src = normalizaImagen(b.imagen);

  } catch (err) {
    document.getElementById('nombre').textContent = 'Error de invocación: ' + err.message;
  }
}

document.getElementById('btn-recargar').addEventListener('click', cargar);
document.getElementById('btn-refrescar').addEventListener('click', () => {
  window.location.href = window.location.pathname + '?t=' + Date.now();
});

// cargar al iniciar
cargar();
</script>

</body>
</html>
